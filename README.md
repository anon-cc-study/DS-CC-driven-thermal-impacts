# DS-CC-driven-thermal-impacts
# Load Forecasting, Thermal Modeling, and Power Flow Analysis Pipeline

This repository contains the complete computational workflow used to preprocess weather and load data, train machine learning load forecasting models, generate scenario-based predictions, construct weather-dependent thermal model inputs, and perform power flow analyses.

The code is provided to support transparency and reproducibility of the analyses presented in the manuscript **"Compounding climate thermal risks in power distribution networks"**.

## 1. System Requirements

### Hardware Requirements
The code requires a standard computer with enough RAM to support in-memory operations.
* **RAM:** 16 GB+ recommended (dependent on dataset size).
* **CPU:** 4+ cores recommended for parallel processing.
* **GPU:** Not required.

Running the full analysis pipeline across all distribution networks studied in the paper is computationally intensive and is best executed on a high-performance computing (HPC) system to reduce runtime and accommodate memory and storage demands.

### Software Dependencies
The pipeline is implemented in **Python 3.10.9**.
The specific versions tested in this analysis are listed below.

**Core Data & Math:**
* `numpy` (v1.26.4)
* `pandas` (v2.2.3)
* `scipy` (v1.15.1)
* `xarray` (v2024.11.0) 
* `networkx` (v3.4.2)

**Machine Learning & Statistics:**
* `scikit-learn` (v1.5.1)
* `statsmodels` (v0.14.4)
* `mealpy` (v3.0.1)

**Power Flow & Engineering:**
* `opendssdirect-py` (v0.9.4)
* `dss-python` (v0.15.7)

**Geospatial (Disaggregation):**
* `geopandas` (v1.1.0)
* `shapely` (v2.1.1)

**Visualization:**
* `matplotlib` (v3.10.0)
* `seaborn` (v0.13.2)

**Utilities:**
* `pyyaml` (v6.0.2)
* `tqdm` (v4.67.1)
* `openpyxl` (v3.1.5)
* `jupyter` (Core v5.7.2, Client v8.6.3)

**Operating System:**
* **Tested on:** Linux (x86_64)
* *Note:* While tested on Linux, the code is expected to be cross-platform compatible (Windows/macOS) provided the Python environment is set up correctly.

## 2. Installation Guide

### Instructions
1.  Clone the repository:
    ```bash
    git clone [https://github.com/anon-cc-study/DS-CC-driven-thermal-impacts.git](https://github.com/anon-cc-study/DS-CC-driven-thermal-impacts.git)
    cd DS-CC-driven-thermal-impacts
    ```
2.  Create and activate a virtual environment (optional but recommended):
    ```bash
    python -m venv venv
    source venv/bin/activate  # On Windows use: venv\Scripts\activate
    ```
3.  Install dependencies:
    ```bash
    pip install -r requirements.txt
    ```

**Typical Install Time:** Approximately 60 minutes on a "normal" desktop computer.

## 3. Demo
We provide a small dataset to verify the functionality of the software.

### Instructions to Run on Demo Data
1. Locate the sample_data_for_demo/ directory in the repository. This folder contains sample ResStock and weather data required to run the demo.
2. The distribution network dataset, even for the smallest case, is too large to be hosted on GitHub and must be downloaded separately.
Download the distribution network data from:
https://data.openei.org/submissions/2981
3. For demo purposes, it is recommended to use the GSO/rural network, which is the smallest available distribution network in the dataset. Distribution data should be located in ‘SMART-DS\v1.0\2016\GSO\rural’.
4. Update the main_folder path variables in the notebooks to point to the local directory where the repository and downloaded data are stored.
5. Open the notebooks to be tested. Some notebooks depend on outputs generated by earlier notebooks, so they should be executed in numerical order.
6. Run all cells in each notebook to reproduce the demo results.

### Expected Output
* Running the notebooks in numerical order will generate a time-series of buildings demand, smart-ds files that reflect thermal models of transformers and power lines, and power flow outputs (current, voltage and power).
* Notebook '2. POWER FLOW multiple snapshot PF - derating and MLP demand growth.ipynb’ prints bus voltages, circuit loads and line and transformers power flow outputs (current, voltage and power).


**Expected Run Time:** **60-120 minutes** on a standard desktop.

## 4. Instructions for Use

To run the full analysis on user-provided data, follow the modular workflow below. The analysis consists of two modules that must be executed sequentially. Within each module, notebooks must be run in numerical order, as later steps depend on outputs generated earlier.

### Configuration
All user inputs (file paths, scenario parameters, and runtime options) are specified in YAML configuration files located in the config/ directory of each module.
Before running any notebooks, update these configuration files to point to your local datasets.

### Module 1: Machine Learning Demand Forecasting

Folder: machine_learning_demand_forecasting/

This module handles data preparation, machine-learning-based (MLP) demand forecasting, and spatial disaggregation of predictions from feeder-level to building-level demand.

Run the following notebooks in order:

1. DATA PROCESSING Prepare input data for training (resstock load and weather).ipynb
Preprocesses ResStock and weather data for model training.

2. DATA PROCESSING Prepare input data for prediction- TGW weather.ipynb
Prepares climate-scenario (TGW) inputs for downstream prediction.

3. DATA PROCESSING Create resstock dataframes.ipynb
Constructs structured resstock datasets.

4. DATA PROCESSING Create cooling heating and non-CH data for dissaggregation process.ipynb
Prepares building-to-feeder mapping inputs for later disaggregation.

5. TRAIN electricity demand prediction model.ipynb
Trains the machine learning electricity demand forecasting model.

6. PREDICT electricity demand with climate data.ipynb
Generates electricity demand predictions under different climate scenarios.

7. POST DATA PROCESSING Disaggregate feeder to buildings.ipynb
Disaggregates feeder-level demand predictions to individual buildings.

### Module 2: Thermal Models and Power Flow
Folder: thermal_models_and_power_flow/

This module constructs weather-dependent thermal inputs and runs power flow simulations on distribution networks using OpenDSS.

Run the following notebooks in order:    

1. DATA PROCESSING create weather-dependent smartds files.ipynb
Generates weather-adjusted distribution network inputs at each timestep (hourly resolution).

2. POWER FLOW multiple snapshot PF - derating and MLP demand growth.ipynb
Runs power flow simulations and screens for thermally critical timesteps.

### Code Availability and Support

This repository is provided to support transparency and reproducibility of the results reported in the manuscript.

The code is released for research and review purposes.

The repository reflects the analysis version used for peer review.

The code is distributed under the MIT License.

